{
    "build": {
        "dockerfile": "./Dockerfile",
        "context": "."
    },
    "features": {
        "ghcr.io/devcontainers/features/aws-cli:1": {
            "version": "latest"
        },
		"ghcr.io/devcontainers-contrib/features/terraform-asdf:2": {
            "version": "latest"
        },
		"ghcr.io/devcontainers-contrib/features/ansible:2": {
            "version": "latest"
        }
    },
    
    // Use 'forwardPorts' to make a list of ports inside the container available locally.
    // "forwardPorts": [],

    // Configure tool-specific properties.
    "customizations": {
        // Configure properties specific to VS Code.
        "vscode": {
            // Add the IDs of extensions you want installed when the container is created.
            "extensions": [
                "ms-python.python",
		        "ms-azuretools.vscode-docker",
		        "hashicorp.terraform",
		        "redhat.ansible",
		        "redhat.vscode-yaml",
                "ms-kubernetes-tools.vscode-kubernetes-tools",
                "github.vscode-github-actions",
		        "amazonwebservices.aws-toolkit-vscode",
                "pkief.material-icon-theme"
            ]
        },

        "postCreateCommand": [
            "python3 -m pip install --user --upgrade pip",
            "python3 -m pip install --user ansible-lint",
            "python3 -m pip install --user kubernetes",
            "ansible-galaxy collection install community.general amazon.aws kubernetes.core",
            "helm plugin install https://github.com/databus23/helm-diff",
            // eksctl install setup
            "PLATFORM=$(uname -s)_$ARCH",
            "curl -sLO \"https://github.com/eksctl-io/eksctl/releases/latest/download/eksctl_$PLATFORM.tar.gz\"",
            "curl -sL \"https://github.com/eksctl-io/eksctl/releases/latest/download/eksctl_checksums.txt\" | grep $PLATFORM | sha256sum --check",
            "tar -xzf eksctl_$PLATFORM.tar.gz -C /tmp",
            "rm eksctl_$PLATFORM.tar.gz",
            "mv /tmp/eksctl /usr/local/bin"
        ],
        
        "mounts": [
            "source=${localEnv:HOME}/.aws,target=/home/codespace/.aws,type=bind,consistency=cached"
        ]
    }
}